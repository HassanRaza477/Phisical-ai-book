"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[7117],{1009:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"chapters/part1/chapter2","title":"Chapter 2: Fundamentals of ROS 2","description":"Welcome to the engine room. In the last chapter, we saw the high-level map of our \\"Mind-in-Motion\\" stack. Now, we get our hands dirty by learning the most critical piece of that stack: the Robot Operating System (ROS 2).","source":"@site/docs/chapters/part1/chapter2.md","sourceDirName":"chapters/part1","slug":"/chapters/part1/chapter2","permalink":"/Phisical-ai-book/docs/chapters/part1/chapter2","draft":false,"unlisted":false,"editUrl":"https://github.com/HassanRaza477/Phisical-ai-book.git/docs/chapters/part1/chapter2.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 1: Introduction to Physical AI and Humanoid Robotics","permalink":"/Phisical-ai-book/docs/chapters/part1/chapter1"},"next":{"title":"Chapter 3: Simulating Humanoids in Gazebo","permalink":"/Phisical-ai-book/docs/chapters/part1/chapter3"}}');var s=t(4848),o=t(8453);const a={},i="Chapter 2: Fundamentals of ROS 2",l={},c=[{value:"Setting Up Your Workspace",id:"setting-up-your-workspace",level:2},{value:"The Core Concepts: A &quot;Weather Bot&quot; Example",id:"the-core-concepts-a-weather-bot-example",level:2},{value:"1. Nodes: The Building Blocks",id:"1-nodes-the-building-blocks",level:3},{value:"2. Topics: The Mailing List",id:"2-topics-the-mailing-list",level:3},{value:"3. Messages: The Data Format",id:"3-messages-the-data-format",level:3},{value:"Creating the &quot;Weather Bot&quot; Package",id:"creating-the-weather-bot-package",level:3},{value:"The Sensor Node (Python Publisher)",id:"the-sensor-node-python-publisher",level:4},{value:"The Monitor Node (Python Subscriber)",id:"the-monitor-node-python-subscriber",level:4},{value:"Building and Running",id:"building-and-running",level:3},{value:"4. Services: The Remote Procedure Call",id:"4-services-the-remote-procedure-call",level:3},{value:"5. Actions: The Long-Running Task",id:"5-actions-the-long-running-task",level:3},{value:"The ROS 2 Transform System (tf2)",id:"the-ros-2-transform-system-tf2",level:2},{value:"Debugging Tools",id:"debugging-tools",level:2},{value:"The <code>launch</code> System",id:"the-launch-system",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"chapter-2-fundamentals-of-ros-2",children:"Chapter 2: Fundamentals of ROS 2"})}),"\n",(0,s.jsx)(n.p,{children:'Welcome to the engine room. In the last chapter, we saw the high-level map of our "Mind-in-Motion" stack. Now, we get our hands dirty by learning the most critical piece of that stack: the Robot Operating System (ROS 2).'}),"\n",(0,s.jsx)(n.p,{children:"ROS 2 is the nervous system of our robot. It's a flexible framework for writing robotics software, handling everything from low-level device control to high-level task coordination. This chapter is hands-on; you will write code, run commands, and build a foundational understanding of the entire ROS 2 ecosystem."}),"\n",(0,s.jsx)(n.h2,{id:"setting-up-your-workspace",children:"Setting Up Your Workspace"}),"\n",(0,s.jsxs)(n.p,{children:["Before we can write code, we need a place to put it. In ROS 2, this is called a ",(0,s.jsx)(n.strong,{children:"workspace"}),"."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Create a directory for your workspace:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mkdir -p ros2_ws/src\ncd ros2_ws\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Build the workspace (even though it's empty):","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"colcon build\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:['Source the workspace: Every time you open a new terminal, you need to "source" your workspace to make its packages available.',"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"source install/setup.bash\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"the-core-concepts-a-weather-bot-example",children:'The Core Concepts: A "Weather Bot" Example'}),"\n",(0,s.jsx)(n.p,{children:'The best way to learn ROS 2 is to build something. We will create a simple "Weather Bot" with two parts: a sensor that publishes the temperature, and a monitor that subscribes to that temperature and displays it.'}),"\n",(0,s.jsx)(n.h3,{id:"1-nodes-the-building-blocks",children:"1. Nodes: The Building Blocks"}),"\n",(0,s.jsxs)(n.p,{children:["A ",(0,s.jsx)(n.strong,{children:"Node"})," is the fundamental unit of computation in ROS 2. Think of it as a single-purpose program in a larger system. Our Weather Bot will have two nodes: a ",(0,s.jsx)(n.code,{children:"sensor_node"})," and a ",(0,s.jsx)(n.code,{children:"monitor_node"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"2-topics-the-mailing-list",children:"2. Topics: The Mailing List"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Topics"})," are named buses over which nodes exchange messages. They work like a public mailing list. A node can ",(0,s.jsx)(n.strong,{children:"publish"})," messages to a topic, and any node that ",(0,s.jsx)(n.strong,{children:"subscribes"})," to that topic will receive those messages."]}),"\n",(0,s.jsxs)(n.p,{children:["Our ",(0,s.jsx)(n.code,{children:"sensor_node"})," will publish the temperature to a ",(0,s.jsx)(n.code,{children:"/temperature"})," topic. Our ",(0,s.jsx)(n.code,{children:"monitor_node"})," will subscribe to it."]}),"\n",(0,s.jsx)(n.h3,{id:"3-messages-the-data-format",children:"3. Messages: The Data Format"}),"\n",(0,s.jsxs)(n.p,{children:["A ",(0,s.jsx)(n.strong,{children:"Message"})," is the data structure that is sent on a topic. ROS 2 provides many standard message types, and you can create your own. For our ",(0,s.jsx)(n.code,{children:"/temperature"})," topic, we'll use the standard ",(0,s.jsx)(n.code,{children:"sensor_msgs/msg/Temperature"})," message."]}),"\n",(0,s.jsx)(n.h3,{id:"creating-the-weather-bot-package",children:'Creating the "Weather Bot" Package'}),"\n",(0,s.jsx)(n.p,{children:"First, let's create a package inside our workspace to hold our code."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd src\nros2 pkg create --build-type ament_python weather_bot_py\n"})}),"\n",(0,s.jsx)(n.p,{children:"This creates a Python package. Now let's create the nodes."}),"\n",(0,s.jsx)(n.h4,{id:"the-sensor-node-python-publisher",children:"The Sensor Node (Python Publisher)"}),"\n",(0,s.jsxs)(n.p,{children:["Inside ",(0,s.jsx)(n.code,{children:"weather_bot_py/weather_bot_py"}),", create a file named ",(0,s.jsx)(n.code,{children:"sensor_node.py"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# weather_bot_py/weather_bot_py/sensor_node.py\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Temperature\nimport random\n\nclass SensorNode(Node):\n    def __init__(self):\n        super().__init__('sensor_node')\n        self.publisher_ = self.create_publisher(Temperature, 'temperature', 10)\n        self.timer = self.create_timer(1.0, self.timer_callback)\n        self.get_logger().info('Temperature Sensor Node has started.')\n\n    def timer_callback(self):\n        msg = Temperature()\n        msg.header.stamp = self.get_clock().now().to_msg()\n        msg.temperature = random.uniform(15.0, 25.0) # Simulate temperature in Celsius\n        msg.variance = 0.1\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: {msg.temperature:.2f} C')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = SensorNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,s.jsx)(n.h4,{id:"the-monitor-node-python-subscriber",children:"The Monitor Node (Python Subscriber)"}),"\n",(0,s.jsxs)(n.p,{children:["In the same directory, create ",(0,s.jsx)(n.code,{children:"monitor_node.py"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# weather_bot_py/weather_bot_py/monitor_node.py\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Temperature\n\nclass MonitorNode(Node):\n    def __init__(self):\n        super().__init__('monitor_node')\n        self.subscription = self.create_subscription(\n            Temperature,\n            'temperature',\n            self.listener_callback,\n            10)\n        self.get_logger().info('Temperature Monitor Node has started.')\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'I heard: {msg.temperature:.2f} C')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MonitorNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You'll also need to update ",(0,s.jsx)(n.code,{children:"setup.py"})," to make these nodes runnable."]}),"\n",(0,s.jsx)(n.h3,{id:"building-and-running",children:"Building and Running"}),"\n",(0,s.jsxs)(n.p,{children:["Go to the root of your workspace (",(0,s.jsx)(n.code,{children:"ros2_ws"}),") and run ",(0,s.jsx)(n.code,{children:"colcon build"}),". Then source the workspace again."]}),"\n",(0,s.jsx)(n.p,{children:"Now, open two terminals. In both, source your workspace."}),"\n",(0,s.jsxs)(n.p,{children:["In Terminal 1, run the sensor:\n",(0,s.jsx)(n.code,{children:"ros2 run weather_bot_py sensor_node"})]}),"\n",(0,s.jsxs)(n.p,{children:["In Terminal 2, run the monitor:\n",(0,s.jsx)(n.code,{children:"ros2 run weather_bot_py monitor_node"})]}),"\n",(0,s.jsx)(n.p,{children:"You should see the sensor publishing temperatures and the monitor receiving them!"}),"\n",(0,s.jsx)(n.h3,{id:"4-services-the-remote-procedure-call",children:"4. Services: The Remote Procedure Call"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Services"})," are for request-response communication. A ",(0,s.jsx)(n.strong,{children:"Service Server"})," node offers a service, and a ",(0,s.jsx)(n.strong,{children:"Service Client"})," node can call it. Unlike topics, services are synchronous\u2014the client waits for the server to respond."]}),"\n",(0,s.jsx)(n.p,{children:"Let's add a service to our Weather Bot that lets us reset the sensor's \"calibration.\""}),"\n",(0,s.jsx)(n.h3,{id:"5-actions-the-long-running-task",children:"5. Actions: The Long-Running Task"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"}),' are for long-running, feedback-producing tasks. Think of telling a robot to "navigate to the kitchen." You want to know its progress along the way and be able to cancel the goal. Actions have three parts: a goal, feedback, and a result.']}),"\n",(0,s.jsx)(n.h2,{id:"the-ros-2-transform-system-tf2",children:"The ROS 2 Transform System (tf2)"}),"\n",(0,s.jsx)(n.p,{children:"Robots are all about coordinate frames. Where is the hand relative to the arm? Where is the arm relative to the body? Where is the robot relative to the world?"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"tf2"})," is the system that manages all these coordinate frames. A node can ",(0,s.jsx)(n.strong,{children:"broadcast"}),' a transform (e.g., "my hand is here, relative to my arm"), and any other node can ',(0,s.jsx)(n.strong,{children:"listen"})," for that transform to find out the relationship between any two frames. We will use ",(0,s.jsx)(n.code,{children:"rviz2"}),", the primary ROS 2 visualizer, to see these transforms in 3D."]}),"\n",(0,s.jsx)(n.h2,{id:"debugging-tools",children:"Debugging Tools"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:[(0,s.jsx)(n.code,{children:"ros2"})," CLI"]}),": Your primary tool. Use ",(0,s.jsx)(n.code,{children:"ros2 node list"}),", ",(0,s.jsx)(n.code,{children:"ros2 topic list"}),", ",(0,s.jsx)(n.code,{children:"ros2 topic echo /temperature"}),", etc., to inspect the system."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"rqt_graph"})}),": A GUI tool that shows you the node and topic graph. In a new terminal, run ",(0,s.jsx)(n.code,{children:"rqt_graph"}),". You'll see your two nodes and the ",(0,s.jsx)(n.code,{children:"/temperature"})," topic connecting them."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"rviz2"})}),": A powerful 3D visualizer. We will use this extensively to visualize robot models, sensor data, and transforms."]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"the-launch-system",children:["The ",(0,s.jsx)(n.code,{children:"launch"})," System"]}),"\n",(0,s.jsxs)(n.p,{children:["Running each node in a separate terminal is tedious. ",(0,s.jsx)(n.strong,{children:"Launch files"})," are Python scripts that let you start and configure a whole system of nodes at once."]}),"\n",(0,s.jsx)(n.p,{children:"Here's a simple launch file to start our Weather Bot:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# weather_bot_py/launch/weather_bot.launch.py\nfrom launch import LaunchDescription\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n    return LaunchDescription([\n        Node(\n            package='weather_bot_py',\n            executable='sensor_node',\n            name='my_sensor'\n        ),\n        Node(\n            package='weather_bot_py',\n            executable='monitor_node',\n            name='my_monitor'\n        ),\n    ])\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can now run this with ",(0,s.jsx)(n.code,{children:"ros2 launch weather_bot_py weather_bot.launch.py"})," to start both nodes."]}),"\n",(0,s.jsx)(n.p,{children:"This chapter has been a whirlwind tour of ROS 2's fundamental concepts. Don't worry if it's not all crystal clear yet. In the coming chapters, we will use these tools again and again, and they will become second nature."})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var r=t(6540);const s={},o=r.createContext(s);function a(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);